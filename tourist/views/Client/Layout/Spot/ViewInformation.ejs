<section>
  <!-- Page Content -->
  <div class="container-fluid">

    <!-- Portfolio Item Heading -->
    <div class="row">
      <div class="offset-md-2">
        <h1 class="my-4">
          <%= info_rows[0].spot_name.toUpperCase() %>
        </h1>
      </div>
    </div>

    <!-- Portfolio Item Row -->
    <div class="row ">

      <!-- Navigation -->
      <div class="col-md-2">
        <h5 class="section-heading text-uppercase">Categories</h5>
        <% cat_res.forEach(function(row){ %>
        <% if(row.ec_name == 'Festival') { %>
        <a class="portfolio-link" href="/festival">
          <% } else if(row.ec_name == 'Nature') { %>
          <a class="portfolio-link" href="/nature">
            <% } else if(row.ec_name == 'Pasalubong') { %>
            <a class="portfolio-link" href="/pasalubong">
              <% } else if(row.ec_name == 'Transportation') { %>
              <a class="portfolio-link" href="/transportation">
                <% } else if(row.ec_name == 'Banks & Atms') { %>
                <a class="portfolio-link" href="/banks">
                  <% } else if(row.ec_name == 'Restaurant') { %>
                  <a class="portfolio-link" href="/restaurants">
                    <% } else if(row.ec_name == 'Ilocano Delicacies') { %>
                    <a class="portfolio-link" href="/ilocano">
                      <% } else if(row.ec_name == 'Churches & Structures') { %>
                      <a class="portfolio-link" href="/church">
                        <% } else if(row.ec_name == 'Hotels') { %>
                        <a class="portfolio-link" href="/hotels">
                          <% } %>

                          <% if(row.ec_name == 'Festival') { %>
                          <img class="img-fluid mb-3" src="../festivala.jpg" alt="" height="300" width="70">
                          <% } else if(row.ec_name == 'Nature') { %>
                          <img class="img-fluid mb-3" src="../natura.jpg" alt="" height="300" width="70">
                          <% } else if(row.ec_name == 'Pasalubong') { %>
                          <img class="img-fluid mb-3" src="../shopping.jpg" alt="" height="300" width="70">
                          <% } else if(row.ec_name == 'Transportation') { %>
                          <img class="img-fluid mb-3" src="../transportation1.jpg" alt="" height="300" width="70">
                          <% } else if(row.ec_name == 'Banks & Atms') { %>
                          <img class="img-fluid mb-3" src="../banksa.jpg" alt="" height="300" width="70">
                          <% } else if(row.ec_name == 'Restaurant') { %>
                          <img class="img-fluid mb-3" src="../restaurants.jpg" alt="" height="300" width="70">
                          <% } else if(row.ec_name == 'Ilocano Delicacies') { %>
                          <img class="img-fluid mb-3" src="../ilocanodeli.jpg" alt="" height="300" width="70">
                          <img class="img-fluid mb-3" src="../logo.jpg" alt="" height="300" width="70">
                          <% } else if(row.ec_name == 'Churches & Structures') { %>
                          <img class="img-fluid mb-3" src="../museums.jpg" alt="" height="300" width="70">
                          <% } else if(row.ec_name == 'Hotels') { %>
                          <img class="img-fluid mb-3" src="../hotels.jpg" alt="" height="300" width="70">

                          <% } %>

                        </a>
                        <%  }); %>
      </div>

      <div class="col-md-6">
        <div id="carouselExampleFade" class="carousel slide carousel-fade" data-ride="carousel">
          <div class="carousel-inner">
            <% if (images_rows !== "N/A") { %>
            <% images_rows.forEach(function(row, index) { %>
            <div class="carousel-item <% if (index == 0) { %> active <% } %>">
              <img class="d-block w-100" src="/uploads/<%= row.img_filename %>" alt="/uploads/<%= row.img_filename %>"
                height="450">
            </div>
            <%	}); %>
            <% } %>
          </div>
          <a class="carousel-control-prev" href="#carouselExampleFade" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next" href="#carouselExampleFade" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>
        <!-- Maps -->
        <div class="row mt-3">
          <div class="col-md-12">
            <div class="col-md-12" id="map" style="height:350px;width:100%;"></div>
          </div>
        </div>
        <!-- /.row -->
      </div>

      <!-- Descriptions -->
      <div class="col-md-4">
        <h3 class="my-3">Rating:
          <% if (rating.length > 0) { %>
          <%= rating[0].RATES %>
          <% } %>
          <span class="float-right">
            <%- include('../rating/rating.ejs') %>
          </span>
        </h3>
        <h3 class="my-3">Description</h3>
        <p>
          <%- info_rows[0].spot_description %>
        </p>
        <h3 class="my-3">Details</h3>
        <ul>
          <li>
            <%= info_rows[0].town_name %>
          </li>
          <li>
            <%= info_rows[0].bar_name %>
          </li>
        </ul>
        <p>
          <%= sl_route %>
        </p>
      </div>

    </div>
    <!-- /.row -->

    <!-- Related Projects Row -->
    <div class="row mt-3">
      <div class="offset-md-1 col-md-10">

        <% if (user!="null") { %>
        <h3 class="my-4">Just For You</h3>
        <div class="row">
          <% user_recon.forEach(function(recon) { %>
          <div class="col-md-4">
            <div class="card">
              <a href="/<%= recon.sc_name %>/<%= recon.spot_no %>">
                <img class="img-fluid rounded" style="height:200px; width:400px;" src="/uploads/<%= recon.img_filename %>"
                  onerror="if (this.src != 'error.jpg') this.src = '/uploads/default.png';" alt="/uploads/default.png">
              </a>
              <div class="card-body">
                <p class="text-truncate mb-0 pb-0">
                  <%= recon.spot_name %>
                </p>
                <p>Rating:
                  <%= recon.RATES %>
                </p>
              </div>
            </div>
          </div>
          <% }); %>
        </div>
        <div class="row mt-3">
          <% userReconEstab.forEach(function(recon) { %>
          <div class="col-md-4">
            <div class="card">
              <a href="/<%= recon.ec_name %>/<%= recon.estab_no %>">
                <img class="img-fluid rounded" style="height:200px; width:400px;" src="/uploads/<%= recon.image_filename %>"
                  onerror="if (this.src != 'error.jpg') this.src = '/uploads/default.png';" alt="<%= recon.estab_name %>">
              </a>
              <div class="card-body">
                <p class="text-truncate mb-0 pb-0">
                  <%= recon.estab_name %>
                </p>
                <p>Rating:
                  <%= recon.RATES %>
                </p>
              </div>
            </div>
          </div>
          <% }); %>
        </div>
        <% } %>
      </div>
    </div>
    <!-- /.row -->

    <!-- Comments -->
    <div class="row">
      <div class="offset-md-2 col-md-6">
        <form id="form-comments" class="form-inline" action="/<%= route %>/<%= info_rows[0].spot_no %>" method="post">

          <% if (user=="null") { %>
          <img src="/guest.ico" alt="..." class="rounded-circle" height="32" width="32">
          <input type="email" class="form-control" placeholder="Email (Required)" name="email" id="email">
          <input type="text" class="form-control" placeholder="Name (Required)" name="name" id="name">
          <% } %>
      </div>
    </div>
    <div class="row">
      <div class="offset-md-2 col-md-6">
        <textarea class="form-control" id="content" rows="3" style="min-width: 100%" name="comment_content"></textarea>
      </div>
    </div>
    <div class="row">
      <div class="offset-md-2 col-md-6">
        <button class="btn btn-primary float-right" id="comment">Comment</button>
        </form>
      </div>
    </div>
    <hr />
    <%- include('../comment/comment.ejs') %>
  </div>
  </div>
  <!-- /.container -->
</section>

<input type="text" class="form-control" name="el_latitude" id="el_latitude" value="<%= sl_latitude %>" hidden>

<input type="text" class="form-control" name="el_longitude" id="el_longitude" value="<%= sl_lontitude %>" hidden>


<script type="text/javascript">
  window.initMap = function () {
    let dagupan = {
      lat: parseFloat(document.getElementById('el_latitude').value),
      lng: parseFloat(document.getElementById('el_longitude').value)
    };
    map = new google.maps.Map(document.getElementById('map'), {
      zoom: 18,
      center: dagupan
    });

    var marker = new google.maps.Marker({
      position: dagupan,
      map: map
    });
  }   
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBc7MrXyAOjZ9VAmPCniGxbH5MEn0jpP7Q&callback=initMap"></script>

<script>
  $(document).ready(function () {
    $("#form-comments").submit(function (e) {
      var name = $('#name').val();
      var email = $('#email').val();
      var content = $('#content').val();

      // Check if empty of not
      if (name === '' || email === '' || content === '') {
        alert('Name, Email and Comment must be filled.');
        return false;
      }
    });
  });
</script>