
<div class="row">
  <!-- <div class="col-md-8">
    <div id="map" style="height:100%;width:100%;margin:0 auto;"></div>
  </div> -->

  <div class="col-md-7 mx-auto">
    <div class="card">
      <div class="card-header card-header-warning">
        <h4 class="card-title">New Establishment</h4>
      </div>
      <div class="card-body">
        <form action="/admin/establishment" method="POST">
          <div class="row">
            <div class="col-md-12">
              <div class="form-group bmd-form-group">
                <label for="barangay_name" class="bmd-label-floating">Establishment Name</label>
                <input type="text" class="form-control" name="estab_name">
              </div>
              <div class="form-group bmd-form-group">
                <label for="inputState">Category</label>
                <select id="inputState" class="form-control" name="ec_no">
                  <% data.forEach(function(row){ %>
                  <option value="<%= row.ec_no %>"><%= row.ec_name %></option>
                  <%	}); %>  
                </select>
              </div>
              <div class="form-group bmd-form-group">
                <label for="inputState">Town</label>
                <select id="inputState" class="form-control" name="town_no">
                  <% towns.forEach(function(town){ %>
                  <option value="<%= town.town_no %>"><%= town.town_name %></option>
                  <%	}); %>  
                </select>
              </div>
              <div class="form-group bmd-form-group">
                <label for="inputState">Barangay</label>
                <select id="inputState" class="form-control" name="bar_no">
                  <% towns.forEach(function(town){ %>
                  <option value="<%= town.bar_no %>"><%= town.bar_name %></option>
                  <%	}); %>  
                </select>
              </div>
              <label for="exampleFormControlTextarea1">Description</label>
              <textarea class="form-control" name="desc" rows="3"></textarea>
              <div class="form-group bmd-form-group">
                <label for="address" class="bmd-label-floating">Address</label>
                <input type="text" class="form-control" name="address">
              </div>
              <div class="form-group bmd-form-group">
                <label for="email" class="bmd-label-floating">Email</label>
                <input type="text" class="form-control" name="email">
              </div>
              <div class="form-group bmd-form-group">
                <label for="contact" class="bmd-label-floating">Contact Number</label>
                <input type="text" class="form-control" name="contact">
              </div>
            </div>
          <button type="submit" class="btn btn-info pull-right">Save Record</button>
          <div class="clearfix"></div>
        </form>
      </div>
    </div>
  </div>
</div>
<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBc7MrXyAOjZ9VAmPCniGxbH5MEn0jpP7Q&callback=initMap">
</script>
<script>
let map;
let marker;
  function initMap() {
    let dagupan = { lat: 16.0433, lng: 120.3333 };
    map = new google.maps.Map(document.getElementById('map'), {
      zoom: 12,
      center: dagupan
    });

    // This event listener calls addMarker() when the map is clicked.
    map.addListener('click', function(event) {
      marker.setMap(null);
      addMarker(event.latLng, map);
      document.getElementById('lat').value = event.latLng.lat();
      document.getElementById('lng').value =  event.latLng.lng();
    });

    addMarker(dagupan, map);
  }

  // Adds a marker to the map.
  function addMarker(location, map) {
    // Add the marker at the clicked location.
    marker = new google.maps.Marker({
      position: location,
      map: map
    });
  }

</script>